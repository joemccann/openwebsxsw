
$(document).ready(function(){function e(e){OW.position=e.coords,a()}function t(e){log(arguments),OW.position=null}function a(){$("#location-fallback").hide(),f()}function f(e){var t;/localhost/.test(location.href)||/127.0.0.1/.test(location.href)?t="AIzaSyB3EZrxj8MqP881fnxq3txiHtoERjrsop0":t="AIzaSyB22ZpoSy-x1R4mkDGwm6H2AoyVnnFzzY0";var n="https://maps.googleapis.com/maps/api/js?key="+t+"&callback=showMap&sensor="+(OW.hasTouch?!0:!1);(function(){var t=document.createElement("script");t.type="text/javascript",t.async=!0,t.src=n;var r=document.getElementsByTagName("script")[0];r.parentNode.insertBefore(t,r),t.onload=function(){log("Loaded gmaps js..."),e&&e()}})()}log("Ready..."),window.OW={position:null,hasTouch:!0};if(!("ontouchstart"in window)||window.DocumentTouch&&document instanceof DocumentTouch)document.documentElement.className="no-touch",OW.hasTouch=!1;navigator.geolocation?navigator.geolocation.getCurrentPosition(e,t):t("Not supported.");var n=$("#signup-form"),r=$("#signup-button");if(n.length){var i=function(e){r.attr("disabled",!0),$(".error").removeClass("error");var t=$('input[type="email"]'),i=$('input[type="name"]'),s=$('input[type="twitter"]');return i.val().length<2?(log("Bad name."),i.val("").addClass("error").focus(),r.removeAttr("disabled"),!1):/(.+)@(.+){2,}\.(.+){2,}/.test(t.val())?($("#signup-lat").val(OW.position?OW.position.latitude:""),$("#signup-lon").val(OW.position?OW.position.longitude:""),s.val(s.val().replace("@","")),$.post("/signup",n.serialize(),function(e){var t=typeof e=="string"?JSON.parse(e):e;log(t),n.find("input").val(""),r.removeAttr("disabled"),alert("Signup was successful. Stay tuned...")}),!1):(log("Bad email."),t.val("").addClass("error").focus(),r.removeAttr("disabled"),!1)};r.on("click",function(e){return i(e),e.preventDefault(),!1}),n.on("submit",function(e){return i(e),e.preventDefault(),!1})}var s=$("#stripe-button");if(s.length){var o=function(e){var t=e.id,n={amount:u.amount,currency:u.currency,card:t,description:u.description};$.post("/charge",n,function(e){var t=JSON.parse(e);log(t),alert("Payment successful! You wil now be redirected to the home page."),location.href="/"})},u={key:s[0].dataset.key,address:!1,amount:s[0].dataset.amount,name:s[0].dataset.name,description:s[0].dataset.description,currency:s[0].dataset.currency,token:o};s.on("click",function(){return StripeCheckout.open(u),!1})}window.showMap=function(){log("Location stuff is coming soon, bro.")}})